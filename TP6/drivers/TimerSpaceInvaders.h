/*
 * TimerSpaceInvaders.h
 *
 *  Created on: 27 oct. 2008
 *      Author: Aurélien
 */

#ifndef TIMERSPACEINVADERS_H_
#define TIMERSPACEINVADERS_H_

#include "timer.h"
#include "Ecran.h"
#include "sextant/interruptions/handler/handler_tic.h"


extern int compteurTicHandler;

class TimerSpaceInvaders: public Timer {

private:
	/*
	 * Sémaphore bloquant les threads.
	 */
	Semaphore *missileAliens;
	Semaphore *missileCanon;
	Semaphore *deplacementAliens;

	/*
	 * Temps d'attente en ms entre mis à jour du sémaphore.
	 */
	int timerMissileAliens;
	int timerMissilesCanon;
	int timerDeplacementAliens;

public:
	TimerSpaceInvaders(int timerMissileAliens = 500, int timerMissilesCanon = 10,
			int timerDeplacementAliens = 50);

	/*
	 * Permet de faire le lien entre l'IRQ et le driver.
	 * Méthode appelée en boucle dans la méthode principale du jeu.
	 * A modifier afin de faire marcher le sémaphore du handler avec le driver.
	 */
	void handler(Ecran *ecran);

	/*
	 * Accesseurs simples permettant de récuperer les sémaphores pour chacuns des
	 * objets concernés.
	 * Ceux-ci sont débloqués automatiquement par le handler tic lorsque le délai
	 * est dépassé.
	 */
	Semaphore *getMissileAliens();
	Semaphore *getMissileCanon();
	Semaphore *getDeplacementAliens();

	/*
	 * Permet de fixer le délai de mise à jour pour chacun des objets suivants.
	 * Le délai est exprimé en ms, mais arrondi au centième de seconde afin de
	 * garantir des performances supérieures.
	 */
	void setTimerMissileAliens(int ms);
	void setTimerMissileCanon(int ms);
	void setTimerDeplacementAliens(int ms);
};

#endif /* TIMERSPACEINVADERS_H_ */
