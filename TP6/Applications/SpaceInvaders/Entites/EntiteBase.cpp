/*
 * Entite.cpp
 *
 *  Created on: 17 oct. 2008
 *      Author: Aurélien
 */

#include "EntiteBase.h"
#include "Applications/SpaceInvaders/Espace.h"

Espace* EntiteBase::espace = NULL;
Ecran* EntiteBase::ecran = NULL;


EntiteBase::EntiteBase(int v, int ligne, int colonne,
		char *a, int h, int l, Couleur c) {
	vie = v;
	positionLigne = ligne;
	positionColonne = colonne;
	affichage = a;
	hauteur = h;
	largeur = l;
	couleur = c;
}

int EntiteBase::getPositionLigne(){
	return positionLigne;
}
int EntiteBase::getPositionColonne(){
	return positionColonne;
}
int EntiteBase::getHauteur(){
	return hauteur;
}
int EntiteBase::getLargeur(){
	return largeur;
}


bool EntiteBase::estEntiteVide(){
	return false;
}

void EntiteBase::deplacer(int direction){
	effacer();
	if(direction == GAUCHE)
		positionColonne --;
	if(direction == DROITE)
		positionColonne ++;
	if(direction == HAUT)
		positionColonne --;
	if(direction == BAS)
		positionColonne ++;
	dessiner();
}

void EntiteBase::dessiner(){
	for(int ligne=getPositionLigne(); ligne<getPositionLigne()+getHauteur(); ligne++){
		for(int colonne=getPositionColonne(); colonne<getPositionColonne()+getLargeur(); colonne++){
			espace->setEntite(this, ligne, colonne);
			ecran->afficherCaractere(ligne, colonne,
					couleur, espace->getCouleurArPlan(),
					*(affichage + (ligne-positionLigne)*largeur +(colonne-positionColonne)));
		}
	}
}
void EntiteBase::effacer(){
	for(int ligne=positionLigne; ligne<positionLigne+getHauteur(); ligne++){
		for(int colonne=positionColonne; colonne<positionColonne+getLargeur(); colonne++){
			espace->setEntiteVide(ligne, colonne);
			espace->getEntite(ligne, colonne)->dessiner();
		}
	}
}

void EntiteBase::setEcran(Ecran *ec){
	ecran = ec;
}
void EntiteBase::setEspace(Espace *es){
	espace = es;
}
